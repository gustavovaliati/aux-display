<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Page 1</title>
</head>
<body>
    <h1>Control</h1>

    <div id="setup">
        <label for="serverAddress">Server:</label>
        <input id="serverAddress" type="text" value="localhost">
        <input id="serverPort" type="number" value="8080">
        <button id="connectBtn" >Connect</button>
        <br>
        <label for="minutesInput">Minutes:</label>
        <input id="minutesInput" type="number" step="1" value="1" min="0">
        <label for="secondsInput">Seconds:</label>
        <input id="secondsInput" type="number" step="1" value="30" min="0">
        <br>
        <button id="startBtn" style="display: none;" >Start</button>
        <button id="restartBtn" style="display: none;" >Restart</button>
        <button id="pauseBtn" style="display: none;" >Pause</button>
        <button id="stopBtn" style="display: none;" >Stop</button>
    </div>

    <script>
        let serverAddress = document.getElementById('serverAddress').value
        let serverPort = document.getElementById('serverPort').value
        let socket;

        document.getElementById('connectBtn').onclick = function() {
            socket = new WebSocket(`ws://${serverAddress}:${serverPort}`);

            socket.onopen = function() {
                console.log('Connected to WebSocket server');
                document.getElementById('startBtn').style.display = 'block';
                document.getElementById('restartBtn').style.display = 'block';
                document.getElementById('pauseBtn').style.display = 'block';
                document.getElementById('stopBtn').style.display = 'block';
            };

            socket.onerror = function(error) {
                console.error('WebSocket Error:', error);
            };

            socket.onclose = function() {
                console.log('WebSocket connection closed');
                document.getElementById('startBtn').style.display = 'none';
                document.getElementById('restartBtn').style.display = 'none';
                document.getElementById('pauseBtn').style.display = 'none';
                document.getElementById('stopBtn').style.display = 'none';
            };
        };

        document.getElementById('startBtn').addEventListener('click', function() {
            const minutes = parseInt(document.getElementById('minutesInput').value, 10);
            const seconds = parseInt(document.getElementById('secondsInput').value, 10);
            const totalSeconds = (minutes * 60) + seconds;
            const event = {type: "start", seconds: totalSeconds};

            socket.send(JSON.stringify(event));
        });
        document.getElementById('restartBtn').addEventListener('click', function() {
            const event = {type: "restart"};
            socket.send(JSON.stringify(event));
        });
        document.getElementById('pauseBtn').addEventListener('click', function() {
            const event = {type: "pause"};
            socket.send(JSON.stringify(event));
        });
        document.getElementById('stopBtn').addEventListener('click', function() {
            const event = {type: "stop"};
            socket.send(JSON.stringify(event));
        });
    </script>
</body>
</html>